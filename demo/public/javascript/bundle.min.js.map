{"version":3,"sources":["bundle.js"],"names":["require","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length",1,"module","global","compress","file","options","Promise","resolve","reject","window","File","test","type","blob","fileName","name","reader","FileReader","readAsArrayBuffer","onload","event","Blob","target","result","URL","webkitURL","blobURL","createObjectURL","image","Image","src","resized","resize","max_width","max_height","quality","dataURItoBlob","img","width","height","Math","round","canvas","document","createElement","ctx","getContext","drawImage","toDataURL","dataURI","byteString","split","indexOf","atob","unescape","mimeString","ia","Uint8Array","charCodeAt","ES6Promise","jQuery","polyfill","this","self","upload","Uploader","isString","trigger","settings","action","data","accept","multiple","change","error","success","progress","suffix","$","extend","$trigger","eq","attr","parse","setup","bind","val","Object","prototype","toString","createInputs","inputs","value","push","str","ret","pairs","decodeURIComponent","replace","pair","key","findzIndex","$node","parents","parentsUntil","zIndex","item","css","parseInt","newIframe","iframeName","iframeCount","iframe","hide","form","append","FormData","_uploader_","input","setAttribute","position","top","right","opacity","outline","cursor","outerHeight","fontSize","max","offset","left","overflow","outerWidth","appendTo","mouseenter","bindInput","_files","files","pop","submit","optionXhr","xhr","ajaxSettings","addEventListener","percent","loaded","total","lengthComputable","ceil","len","prop","get","then","response","ajax","url","processData","contentType","context","textStatus","errorMsg","err","message","one","remove","trim","contents","find","html","refreshInput","newInput","clone","before","off","callback","me","enable","disable","./lib/compress","upyun","getJson","dataType","getConfig","path","location","origin","protocol","hostname","port","policy","signature","bucket","config","getPath","parseJSON"],"mappings":"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","file":"bundle.min.js","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function (global){\n'use strict'\n\nvar $ = (typeof window !== \"undefined\" ? window.jQuery : typeof global !== \"undefined\" ? global.jQuery : null)\nvar ES6Promise = (typeof window !== \"undefined\" ? window.ES6Promise : typeof global !== \"undefined\" ? global.ES6Promise : null)\nES6Promise.polyfill()\n\n/**\n * compress (now only support image)\n * @param  {File}    file\n * @param  {object}  options {max_width, max_height, quality}\n * @return {Promise}\n */\nfunction compress(file, options) {\n    options = options || {}\n    return new Promise(function (resolve, reject) {\n        if (!window.File) {\n            reject(new Error('not support'))\n            return\n        }\n        if (!(file instanceof File)) {\n            reject(new Error('file error'))\n        }\n        if(!(/image/i).test(file.type)) {\n            resolve({\n                blob: file,\n                fileName: file.name\n            })\n            return\n        }\n\n        // read the files\n        var reader = new FileReader()\n        reader.readAsArrayBuffer(file)\n        reader.onload = function (event) {\n\n            // blob stuff\n            var blob = new Blob([event.target.result])\n            window.URL = window.URL || window.webkitURL\n            var blobURL = window.URL.createObjectURL(blob)\n\n            // helper Image object\n            var image = new Image()\n            image.src = blobURL\n            image.onload = function() {\n\n                // have to wait till it's loaded\n                // send it to canvas\n                // var ext = file.name.slice(file.name.lastIndexOf('.') + 1)\n                var resized = resize(image, file.type, options.max_width, options.max_height, options.quality)\n                var blob = dataURItoBlob(resized)\n                resolve({\n                    blob: blob,\n                    fileName: file.name\n                })\n            }\n        }\n    })\n}\n\n/**\n * resize Image through canvas\n * @param  {Image}  img\n * @param  {number} max_width\n * @param  {number} max_height\n * @param  {number} quality\n * @return {string} base64/URLEncoded data\n */\nfunction resize(img, type, max_width, max_height, quality) {\n    var width = img.width\n    var height = img.height\n    max_width = max_width || width\n    max_height = max_height || height\n    quality = quality || 0.7\n\n    // calculate the width and height, constraining the proportions\n    if (width > height) {\n        if (width > max_width) {\n            height = Math.round(height *= max_width / width)\n            width = max_width\n        }\n    } else {\n        if (height > max_height) {\n            width = Math.round(width *= max_height / height)\n            height = max_height\n        }\n    }\n\n    // resize the canvas and draw the image data into it\n    var canvas = document.createElement('canvas')\n    canvas.width = width\n    canvas.height = height\n    var ctx = canvas.getContext(\"2d\")\n    ctx.drawImage(img, 0, 0, width, height)\n    return canvas.toDataURL(type, quality)\n}\n\n/**\n * convert base64/URLEncoded data component to raw binary data held in a string\n * @param  {string} dataURI base64/URLEncoded data\n * @return {string}         raw binary data\n */\nfunction dataURItoBlob(dataURI) {\n    var byteString\n    if (dataURI.split(',')[0].indexOf('base64') >= 0) {\n        byteString = atob(dataURI.split(',')[1])\n    }\n    else {\n        byteString = unescape(dataURI.split(',')[1])\n    }\n\n    // separate out the mime component\n    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]\n\n    // write the bytes of the string to a typed array\n    var ia = new Uint8Array(byteString.length)\n    for (var i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i)\n    }\n    return new Blob([ia], {type:mimeString})\n}\n\nmodule.exports = compress\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],\"upload\":[function(require,module,exports){\n(function (global){\n/*\n * src: arale/upload\n */\n\n'use strict'\n\nvar $ = (typeof window !== \"undefined\" ? window.jQuery : typeof global !== \"undefined\" ? global.jQuery : null)\nvar compress = require('./lib/compress')\nvar iframeCount = 0\nfunction Uploader(options) {\n    if (!(this instanceof Uploader)) {\n        return new Uploader(options)\n    }\n    if (isString(options)) {\n        options = {trigger: options}\n    }\n    var settings = {\n        trigger: null,\n        name: null,\n        action: null,\n        data: null,\n        accept: null,\n        multiple: true,\n        change: null,\n        error: null,\n        success: null,\n        progress: null,\n        suffix: null,\n        compress: null\n    }\n    if (options) {\n        $.extend(settings, options)\n    }\n    var $trigger = $(settings.trigger).eq(0)\n\n    // support basic data-api\n    settings.action = settings.action || $trigger.data('action') || '/upload'\n    settings.name = settings.name || $trigger.attr('name') || $trigger.data('name') || 'file'\n    settings.data = settings.data || parse($trigger.data('data'))\n    settings.accept = settings.accept || $trigger.data('accept')\n    settings.suffix = settings.suffix || $trigger.data('suffix')\n    settings.compress = settings.compress || parse($trigger.data('compress'))\n    settings.success = settings.success || $trigger.data('success')\n    this.settings = settings\n\n    this.setup()\n    this.bind()\n}\n\n// initialize\n// create input, form, iframe\nUploader.prototype.setup = function () {\n    this.form = $(\n        '<form method=\"post\" enctype=\"multipart/form-data\"'\n        + 'target=\"\" action=\"' + this.settings.action + '\" />'\n    )\n\n    var data = this.settings.data\n    this.form.append(createInputs(data))\n    if (window.FormData) {\n        this.form.append(createInputs({'_uploader_': 'formdata'}))\n    } else {\n        this.form.append(createInputs({'_uploader_': 'iframe'}))\n    }\n\n    var input = document.createElement('input')\n    input.type = 'file'\n    input.name = this.settings.name\n    if (this.settings.accept) {\n        input.accept = this.settings.accept\n    }\n    if (this.settings.multiple) {\n        input.multiple = true\n        input.setAttribute('multiple', 'multiple')\n    }\n    this.input = $(input)\n\n    var $trigger = $(this.settings.trigger)\n    this.input.attr('hidefocus', true).css({\n        position: 'absolute',\n        top: 0,\n        right: 0,\n        opacity: 0,\n        outline: 0,\n        cursor: 'pointer',\n        height: $trigger.outerHeight(),\n        fontSize: Math.max(64, $trigger.outerHeight() * 5)\n    })\n    this.form.append(this.input)\n    this.form.css({\n        position: 'absolute',\n        top: $trigger.offset().top,\n        left: $trigger.offset().left,\n        overflow: 'hidden',\n        width: $trigger.outerWidth(),\n        height: $trigger.outerHeight(),\n        zIndex: findzIndex($trigger) + 10\n    }).appendTo('body')\n    return this\n}\n\n// bind events\nUploader.prototype.bind = function () {\n    var self = this\n    var $trigger = $(self.settings.trigger)\n    $trigger.mouseenter(function () {\n        self.form.css({\n            top: $trigger.offset().top,\n            left: $trigger.offset().left,\n            width: $trigger.outerWidth(),\n            height: $trigger.outerHeight()\n        })\n    })\n    self.bindInput()\n}\n\nUploader.prototype.bindInput = function () {\n    var self = this\n    self.input.change(function(e) {\n\n        // ie9- don't support FileList Object\n        self._files = this.files || [{\n            name: e.target.value\n        }]\n        var file = self.input.val()\n\n        // 根据文件后缀进行过滤\n        var files = self._files\n        var suffix = ''\n        for (var i = 0; i < files[i].length; i++) {\n            suffix = files[i].name.split('.').pop()\n            if (self.settings.suffix.indexOf(suffix) === -1) {\n                if (self.settings.error) {\n                    self.settings.error(new Error('type error'))\n                }\n                return\n            }\n        }\n\n        if (self.settings.change) {\n            self.settings.change.call(self, self._files)\n        } else if (file) {\n            self.submit()\n        }\n    })\n}\n\n// handle submit event\n// prepare for submiting form\nUploader.prototype.submit = function () {\n    var self = this\n    if (window.FormData && self._files) {\n\n        // build a FormData\n        // var form = new FormData(self.form.get(0));\n        // use FormData to upload\n        // form.append(self.settings.name, self._files);\n        var files = self._files\n        var optionXhr\n        if (self.settings.progress) {\n\n            // fix the progress target file\n            optionXhr = function () {\n                var xhr = $.ajaxSettings.xhr()\n                if (xhr.upload) {\n                    xhr.upload.addEventListener('progress', function(event) {\n                        var percent = 0\n                        var position = event.loaded || event.position\n                        var total = event.total\n                        if (event.lengthComputable) {\n                                percent = Math.ceil(position / total * 100)\n                        }\n                        self.settings.progress(event, position, total, percent, files)\n                    }, false)\n                }\n                return xhr\n            }\n        }\n\n        // upyun server do not support multiple files upload\n        var len = files.length\n        self.input.prop('disabled', true)\n        var form = new FormData(self.form.get(0))\n        self.input.prop('disabled', false)\n\n        for (var i = 0; i < len; i++) {\n            compress(files[i], self.settings.compress).then(function (response) {\n                form.append(self.settings.name, response.blob, response.fileName)\n                $.ajax({\n                    url: self.settings.action,\n                    type: 'post',\n                    processData: false,\n                    contentType: false,\n                    data: form,\n                    xhr: optionXhr,\n                    context: this,\n                    success: self.settings.success,\n                    error: function (xhr, textStatus, errorMsg) {\n                        if (self.settings.error) {\n                            self.settings.error(new Error(errorMsg))\n                        }\n                    }\n                })\n            })['catch'](function (err) {\n                if (self.settings.error) {\n                    self.settings.error(new Error(err.message))\n                }\n            })\n        }\n        return this\n    } else {\n\n        // iframe upload\n        self.iframe = newIframe()\n        self.form.attr('target', self.iframe.attr('name'))\n        $('body').append(self.iframe)\n        self.iframe.one('load', function () {\n\n            // Fix for IE endless progress bar activity bug\n            // (happens on form submits to iframe targets):\n            $('<iframe src=\"javascript:false;\"></iframe>')\n                .appendTo(self.form)\n                .remove()\n            var response\n            try {\n                response = $.trim($(this).contents().find(\"body\").html())\n            } catch (e) {\n                if (self.settings.error) {\n                    self.settings.error(new Error('cross domain'))\n                }\n            }\n            if (response) {\n                if (self.settings.success) {\n                    self.settings.success(response)\n                }\n            }\n            self.iframe.remove()\n        })\n        self.form.submit()\n    }\n    return this\n}\n\nUploader.prototype.refreshInput = function () {\n\n    //replace the input element, or the same file can not to be uploaded\n    var newInput = this.input.clone()\n    this.input.before(newInput)\n    this.input.off('change')\n    this.input.remove()\n    this.input = newInput\n    this.bindInput()\n}\n\n// handle change event\n// when value in file input changed\nUploader.prototype.change = function(callback) {\n    if (!callback) {\n        return this\n    }\n    this.settings.change = callback\n    return this\n}\n\n// handle when upload success\nUploader.prototype.success = function(callback) {\n    var me = this\n    this.settings.success = function(response) {\n        me.refreshInput()\n        if (callback) {\n            callback(response)\n        }\n    }\n    return this\n}\n\n// handle when upload error\nUploader.prototype.error = function(callback) {\n    var me = this\n    this.settings.error = function(response) {\n        if (callback) {\n            me.refreshInput()\n            callback(response)\n        }\n    }\n    return this\n}\n\n// add progress\nUploader.prototype.progress = function(callback) {\n    if (!callback) {\n        return this\n    }\n    this.settings.progress = callback\n    return this\n}\n\n// enable\nUploader.prototype.enable = function () {\n    this.input.prop('disabled', false)\n    this.input.css('cursor', 'pointer')\n}\n\n// disable\nUploader.prototype.disable = function () {\n    this.input.prop('disabled', true)\n    this.input.css('cursor', 'not-allowed')\n}\n\n// Helpers\n// -------------\n\nfunction isString(val) {\n    return Object.prototype.toString.call(val) === '[object String]'\n}\n\nfunction createInputs(data) {\n    if (!data) return []\n\n    var inputs = [], i\n    for (var name in data) {\n        i = document.createElement('input')\n        i.type = 'hidden'\n        i.name = name\n        i.value = data[name]\n        inputs.push(i)\n    }\n    return inputs\n}\n\nfunction parse(str) {\n    if (!str) return {}\n    var ret = {}\n\n    var pairs = str.split('&')\n    var unescape = function(s) {\n        return decodeURIComponent(s.replace(/\\+/g, ' '))\n    }\n\n    for (var i = 0; i < pairs.length; i++) {\n        var pair = pairs[i].split('=')\n        var key = unescape(pair[0])\n        var val = unescape(pair[1])\n        ret[key] = val\n    }\n\n    return ret\n}\n\nfunction findzIndex($node) {\n    var parents = $node.parentsUntil('body')\n    var zIndex = 0\n    for (var i = 0; i < parents.length; i++) {\n        var item = parents.eq(i)\n        if (item.css('position') !== 'static') {\n            zIndex = parseInt(item.css('zIndex'), 10) || zIndex\n        }\n    }\n    return zIndex\n}\n\nfunction newIframe() {\n    var iframeName = 'iframe-uploader-' + iframeCount\n    var iframe = $('<iframe name=\"' + iframeName + '\" />').hide()\n    iframeCount += 1\n    return iframe\n}\n\nmodule.exports = Uploader\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./lib/compress\":1}],\"upyun\":[function(require,module,exports){\n(function (global){\n'use strict'\n\nvar $ = (typeof window !== \"undefined\" ? window.jQuery : typeof global !== \"undefined\" ? global.jQuery : null)\nvar ES6Promise = (typeof window !== \"undefined\" ? window.ES6Promise : typeof global !== \"undefined\" ? global.ES6Promise : null)\nvar compress = require('./lib/compress')\n\nES6Promise.polyfill()\n\n// get server config\nvar getJson = function (url, data) {\n    return new Promise(function (resolve, reject) {\n        $.ajax({\n            url: url,\n            dataType: 'json',\n            data: data,\n            success: function (response) {\n                if (response.success) {\n                    resolve(response.message)\n                } else {\n                    reject(new Error(response.message))\n                }\n            },\n            error: function (xhr, textStatus, errorMsg) {\n                reject(new Error(errorMsg))\n            }\n        })\n    })\n}\n\nexports.getConfig = function (path, options) {\n    path = path || '/config/upyun/'\n    if (!window.location.origin) {\n        window.location.origin = window.location.protocol + \"//\" +\n            window.location.hostname + (window.location.port ? ':' +\n            window.location.port: '')\n    }\n    var url = window.location.origin + path\n    options = options || {}\n    if (window.FormData) {\n        if (options['return-url']) {\n            delete options['return-url']\n        }\n    } else {\n        options['return-url'] = true\n    }\n    return getJson(url, options).then(function (response) {\n        var data = {}\n        data.policy = response.policy\n        data.signature = response.signature\n        var action = 'http://v0.api.upyun.com/' + response.bucket\n        var config = {\n            data: data,\n            action: action,\n            name: 'file'\n        }\n        return config\n    })\n}\n\nexports.getPath = function (response) {\n    var url = $.parseJSON(response).url\n    url = 'http://bxmedia.b0.upaiyun.com' + url\n    return url\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./lib/compress\":1}]},{},[\"upload\",\"upyun\"]);\n"],"sourceRoot":"/source/"}
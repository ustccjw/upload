{"version":3,"sources":["bundle.min.js"],"names":["e","exports","module","define","amd","f","window","global","self","imageUpload","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"vendor","options","$","isPlainObject","vendorLib","getConfig","then","config","extend","Upload","getPath","response","suffix","./lib/upload","./lib/vendor",2,"compress","file","File","FileReader","URL","test","type","Promise","resolve","reader","readAsArrayBuffer","onload","event","blob","Blob","target","result","webkitURL","blobURL","createObjectURL","image","Image","src","dataURI","resize","dataURItoBlob","img","width","height","max_width","max_height","quality","Math","round","canvas","document","createElement","ctx","getContext","drawImage","toDataURL","byteString","split","indexOf","atob","unescape","mimeString","ia","Uint8Array","charCodeAt","ES6Promise","polyfill","this",3,"settings","trigger","name","action","accept","data","multiple","change","error","success","progress","setup","bind","createInputs","inputs","value","push","findzIndex","$node","parents","parentsUntil","zIndex","item","eq","css","parseInt","newIframe","iframeName","iframeCount","iframe","hide","prototype","form","append","input","setAttribute","$trigger","attr","position","top","right","opacity","outline","cursor","outerHeight","fontSize","max","offset","left","overflow","outerWidth","appendTo","mouseenter","bindInput","files","pop","suffixArr","map","trim","inArray","submit","refreshInput","FormData","ajaxSubmit","formSubmit","prop","get","promiseArr","each","index","promise","err","message","ajax","url","processData","contentType","xhr","ajaxSettings","upload","addEventListener","percent","loaded","total","lengthComputable","ceil","textStatus","errorMsg","all","one","remove","contents","find","html","newInput","clone","before","off","callback","./compress",4,"getJson","reject","dataType","location","origin","protocol","hostname","port","query","return-url","uploadUrl","uploadParams","fileKey","parseJSON","replace"],"mappings":"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","file":"bundle.min.js","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.imageUpload=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nvar Upload = require('./lib/upload')\nvar vendorLib = require('./lib/vendor')\n\n/**\n * imageUpload function\n * @param  {string} vendor  'upyun/qiniu/upyun_im'\n * @param  {Object} options upload config\n * @return {Promise}        promise resolve upload object, reject any error\n * err message: 'server_config error: xxxx'\n * upload error will call error function(options.error)\n */\nfunction imageUpload(vendor, options) {\n    if ($.isPlainObject(vendor)) {\n        options = vendor\n        vendor = 'upyun'\n    }\n    if (!$.isPlainObject(options)) {\n        options = {}\n    }\n    vendor = vendor || 'upyun'\n    options = options || {}\n    return vendorLib.getConfig('image', vendor).then(function (config) {\n        $.extend(options, config)\n        return new Upload(options)\n    })\n}\n\n/**\n * get uploaded image path\n * @param  {string} response reponse Json String\n * @param  {string} suffix   path suffix(180x180)\n * @return {string}          url path, if response is invalid, return null\n */\nimageUpload.getPath = function (vendor, response, suffix) {\n    return vendorLib.getPath('image', vendor, response, suffix)\n}\n\nmodule.exports = imageUpload\n\n},{\"./lib/upload\":3,\"./lib/vendor\":4}],2:[function(require,module,exports){\n(function (global){\n'use strict'\n\nvar ES6Promise = (typeof window !== \"undefined\" ? window.ES6Promise : typeof global !== \"undefined\" ? global.ES6Promise : null)\nES6Promise.polyfill()\n\n/**\n * compress (now only support image)\n * @param  {File}    file\n * @param  {object}  options {max_width, max_height, quality}\n * @return {Promise}\n */\nfunction compress(file, options) {\n\n    // check File support\n    if (!window.File || !window.FileReader || !window.URL) {\n        return Promise.resolve(file)\n    }\n\n    // do not compress\n    if (options === false || !(/image/i).test(file.type)) {\n        return Promise.resolve(file)\n    }\n\n    options = options || {}\n    return new Promise(function (resolve, reject) {\n\n        // read the files\n        var reader = new FileReader()\n        reader.readAsArrayBuffer(file)\n        reader.onload = function (event) {\n\n            // blob stuff\n            var blob = new Blob([event.target.result])\n            window.URL = window.URL || window.webkitURL\n            var blobURL = window.URL.createObjectURL(blob)\n\n            // helper Image object\n            var image = new Image()\n            image.src = blobURL\n            image.onload = function() {\n\n                // send it to canvas\n                var dataURI = resize(image, file.type, options)\n                var blob = dataURItoBlob(dataURI)\n                resolve(blob)\n            }\n        }\n    })\n}\n\n/**\n * resize Image through canvas\n * @param  {Image}  img      DOM Element\n * @param  {string} type     MIME-STRING\n * @param  {number} options  {max_width, max_height, quality}\n * @return {string}          base64/URLEncoded data\n */\nfunction resize(img, type, options) {\n    var width = img.width\n    var height = img.height\n    var max_width = options.max_width || width\n    var max_height = options.max_height || height\n    var quality = options.quality || 0.7\n\n    // calculate the width and height, constraining the proportions\n    if (width > height) {\n        if (width > max_width) {\n            height = Math.round(height *= max_width / width)\n            width = max_width\n        }\n    } else {\n        if (height > max_height) {\n            width = Math.round(width *= max_height / height)\n            height = max_height\n        }\n    }\n\n    // resize the canvas and draw the image data into it\n    var canvas = document.createElement('canvas')\n    canvas.width = width\n    canvas.height = height\n    var ctx = canvas.getContext(\"2d\")\n    ctx.drawImage(img, 0, 0, width, height)\n    return canvas.toDataURL(type, quality)\n}\n\n/**\n * convert base64/URLEncoded data component to raw binary data held in a string\n * @param  {string} dataURI base64/URLEncoded data\n * @return {string}         raw binary data\n */\nfunction dataURItoBlob(dataURI) {\n    var byteString = ''\n    if (dataURI.split(',')[0].indexOf('base64') >= 0) {\n        byteString = atob(dataURI.split(',')[1])\n    }\n    else {\n        byteString = unescape(dataURI.split(',')[1])\n    }\n\n    // separate out the mime component\n    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]\n\n    // write the bytes of the string to a typed array\n    var ia = new Uint8Array(byteString.length)\n    for (var i = 0; i < byteString.length; i++) {\n        ia[i] = byteString.charCodeAt(i)\n    }\n    return new Blob([ia], {type: mimeString})\n}\n\nmodule.exports = compress\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],3:[function(require,module,exports){\n(function (global){\n/*\n * Base on arale/upload\n * error message: 'suffix error/compress error/cross_domain error/upload error'\n * error will call settings.error function\n * Suffix error will only stop uploading current file, if multiple is valid, other files will be continue to upload\n * Compress error only do not compress, do not stop uploading\n */\n\n'use strict'\n\nvar ES6Promise = (typeof window !== \"undefined\" ? window.ES6Promise : typeof global !== \"undefined\" ? global.ES6Promise : null)\nvar compress = require('./compress')\n\nES6Promise.polyfill()\nvar iframeCount = 0\n\n/**\n * Upload constructor\n * @param {Object} options config\n */\nfunction Upload(options) {\n    if (!(this instanceof Upload)) {\n        return new Upload(options)\n    }\n    if (!$.isPlainObject(options)) {\n        options = {}\n    }\n    var settings = {\n        trigger: null,\n        name: 'file',\n        action: '/upload',\n        accept: null,\n        data: null,\n        multiple: true,\n        change: null,\n        error: null,\n        success: null,\n        progress: null,\n        suffix: null,\n        compress: null\n    }\n    $.extend(settings, options)\n    this.settings = settings\n\n    this.setup()\n    this.bind()\n}\n\n/**\n * init hidden form contains hidden input(settings.data) and file input\n */\nUpload.prototype.setup = function () {\n    this.form = $(\n        '<form method=\"post\" enctype=\"multipart/form-data\"'\n        + 'target=\"\" action=\"' + this.settings.action + '\" />'\n    )\n\n    var data = this.settings.data\n    this.form.append(createInputs(data))\n\n    var input = document.createElement('input')\n    input.type = 'file'\n    input.name = this.settings.name\n    if (this.settings.accept) {\n        input.accept = this.settings.accept\n    }\n    if (this.settings.multiple) {\n        input.multiple = true\n        input.setAttribute('multiple', 'multiple')\n    }\n    this.input = $(input)\n\n    var $trigger = $(this.settings.trigger)\n    this.input.attr('hidefocus', true).css({\n        position: 'absolute',\n        top: 0,\n        right: 0,\n        opacity: 0,\n        outline: 0,\n        cursor: 'pointer',\n        height: $trigger.outerHeight(),\n        fontSize: Math.max(64, $trigger.outerHeight() * 5)\n    })\n    this.form.append(this.input)\n    this.form.css({\n        position: 'absolute',\n        top: $trigger.offset().top,\n        left: $trigger.offset().left,\n        overflow: 'hidden',\n        width: $trigger.outerWidth(),\n        height: $trigger.outerHeight(),\n        zIndex: findzIndex($trigger) + 10\n    }).appendTo('body')\n}\n\n/**\n * bind the trigger element to hidden form\n */\nUpload.prototype.bind = function () {\n    var self = this\n    var $trigger = $(self.settings.trigger)\n    $trigger.mouseenter(function () {\n        self.form.css({\n            top: $trigger.offset().top,\n            left: $trigger.offset().left,\n            width: $trigger.outerWidth(),\n            height: $trigger.outerHeight()\n        })\n    })\n    self.bindInput()\n}\n\n/**\n * handle file input change event\n * it will be filtered via suffix\n */\nUpload.prototype.bindInput = function () {\n    var self = this\n    self.files = []\n    self.input.change(function(e) {\n        self.files = []\n\n        // ie9- don't support FileList Object\n        var files = this.files || [{\n            name: e.target.value.split('\\\\').pop()\n        }]\n\n        // filter via suffix\n        if (self.settings.suffix) {\n            var suffixArr = self.settings.suffix.split(',')\n            suffixArr = $.map(suffixArr, function (value, key) {\n                return $.trim(value)\n            })\n            for (var i = 0; i < files.length; i++) {\n                if ($.inArray(files[i].name.split('.').pop(), suffixArr) !== -1) {\n                    self.files.push(files[i])\n                } else {\n                    if (self.settings.error) {\n                        self.settings.error(new Error('suffix error'), files[i].name)\n                    }\n                }\n            }\n        }\n\n        // no accept suffix\n        if (!self.files.length) {\n            self.refreshInput()\n            return\n        }\n        if (self.settings.change) {\n            self.settings.change.call(self, self.files)\n        } else {\n            self.submit()\n        }\n    })\n}\n\n/**\n * upload file to serevr\n * use ajax or form\n */\nUpload.prototype.submit = function () {\n    if (window.FormData) {\n        this.ajaxSubmit()\n    } else {\n        this.formSubmit()\n    }\n}\n\n/**\n * upload file by ajax\n * it will be compressed\n * success or error will trigger callback function\n */\nUpload.prototype.ajaxSubmit = function () {\n    var self = this\n\n    // upyun server do not support multiple files upload\n    var files = self.files\n    self.input.prop('disabled', true)\n    var form = new FormData(self.form.get(0))\n    self.input.prop('disabled', false)\n\n    var promiseArr = []\n    $.each(files, function (index, file) {\n        var promise = compress(file, self.settings.compress)['catch'](function (err) {\n\n            // compress failed\n            if (self.settings.error) {\n                self.settings.error(new Error('compress error: ' + err.message), file.name)\n            }\n        }).then(function (blob) {\n            blob = blob || file\n            form.append(self.settings.name, blob, file.name)\n            return new Promise(function (resolve, reject) {\n                $.ajax({\n                    url: self.settings.action,\n                    type: 'post',\n                    processData: false,\n                    contentType: false,\n                    data: form,\n                    xhr: function () {\n                        var xhr = $.ajaxSettings.xhr()\n                        if (xhr.upload && self.settings.progress) {\n                            xhr.upload.addEventListener('progress', function(event) {\n                                var percent = 0\n                                var position = event.loaded || event.position\n                                var total = event.total\n                                if (event.lengthComputable) {\n                                    percent = Math.ceil(position / total * 100)\n                                }\n                                self.settings.progress(event, position, total, percent, file.name)\n                            }, false)\n                        }\n                        return xhr\n                    },\n                    success: function (data) {\n                        if (self.settings.success) {\n                            self.settings.success(data, file.name)\n                        }\n                        resolve()\n                    },\n                    error: function (xhr, textStatus, errorMsg) {\n                        if (self.settings.error) {\n                            self.settings.error(new Error('upload error: ' + errorMsg), file.name)\n                        }\n                        resolve()\n                    }\n                })\n            })\n        })\n        promiseArr.push(promise)\n    })\n\n    // upload finished then refresh\n    Promise.all(promiseArr).then(function () {\n        self.refreshInput()\n    })\n}\n\n/**\n * upload file by form submit\n * success or error will trigger callback function\n */\nUpload.prototype.formSubmit = function () {\n    var self = this\n    self.iframe = newIframe()\n    self.form.attr('target', self.iframe.attr('name'))\n    self.iframe.data('fileName', self.files[0].name)\n    $('body').append(self.iframe)\n    self.iframe.one('load', function () {\n\n        // Fix for IE endless progress bar activity bug\n        // (happens on form submits to iframe targets):\n        $('<iframe src=\"javascript:false;\"></iframe>')\n            .appendTo(self.form)\n            .remove()\n        var response = ''\n        try {\n            response = $.trim($(this).contents().find(\"body\").html())\n        } catch (e) {\n            if (self.settings.error) {\n                self.settings.error(new Error('cross_domain error'), $(this).data('fileName'))\n            }\n        } finally {\n            if (response && self.settings.success) {\n                self.settings.success(response, $(this).data('fileName'))\n            }\n\n            // upload finished then refresh\n            self.refreshInput()\n            self.iframe.remove()\n        }\n    })\n    self.form.submit()\n}\n\n/**\n * replace the input element\n * or the same file can not to be uploaded\n */\nUpload.prototype.refreshInput = function () {\n    var newInput = this.input.clone()\n    this.input.before(newInput)\n    this.input.off('change')\n    this.input.remove()\n    this.input = newInput\n    this.bindInput()\n}\n\n/**\n * set settings.change\n * @param  {Function} callback override settings.change\n * @return {Object}            upload object\n */\nUpload.prototype.change = function(callback) {\n    if (!callback) {\n        return this\n    }\n    this.settings.change = callback\n    return this\n}\n\n/**\n * set settings.success\n * @param  {Function} callback override settings.success\n * @return {Object}            upload object\n */\nUpload.prototype.success = function(callback) {\n    if (!callback) {\n        return this\n    }\n    this.settings.success = callback\n    return this\n}\n\n/**\n * set settings.error\n * @param  {Function} callback override settings.error\n * @return {Object}            upload object\n */\nUpload.prototype.error = function(callback) {\n    if (!callback) {\n        return this\n    }\n    this.settings.error = callback\n    return this\n}\n\n/**\n * set settings.progress\n * @param  {Function} callback override settings.progress\n * @return {Object}            upload object\n */\nUpload.prototype.progress = function(callback) {\n    if (!callback) {\n        return this\n    }\n    this.settings.progress = callback\n    return this\n}\n\n/**\n * create hidden input for data\n * @param  {Object} data settings.data\n * @return {Array}       array of hidden input\n */\nfunction createInputs(data) {\n    if (!data) return []\n    var inputs = [], i\n    for (var name in data) {\n        i = document.createElement('input')\n        i.type = 'hidden'\n        i.name = name\n        i.value = data[name]\n        inputs.push(i)\n    }\n    return inputs\n}\n\n/**\n * find the parents\n * @param  {jQueryElement} $node\n * @return {number}               parents max zIndex + 10\n */\nfunction findzIndex($node) {\n    var parents = $node.parentsUntil('body')\n    var zIndex = 0\n    for (var i = 0; i < parents.length; i++) {\n        var item = parents.eq(i)\n        if (item.css('position') !== 'static') {\n            zIndex = parseInt(item.css('zIndex'), 10) || zIndex\n        }\n    }\n    return zIndex\n}\n\n/**\n * init iframe when trigger form submit\n * @return {jQueryElement} iframe element of jQuery\n */\nfunction newIframe() {\n    var iframeName = 'iframe-Upload-' + iframeCount\n    var iframe = $('<iframe name=\"' + iframeName + '\" />').hide()\n    iframeCount += 1\n    return iframe\n}\n\nmodule.exports = Upload\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./compress\":2}],4:[function(require,module,exports){\n(function (global){\n'use strict'\n\nvar ES6Promise = (typeof window !== \"undefined\" ? window.ES6Promise : typeof global !== \"undefined\" ? global.ES6Promise : null)\nES6Promise.polyfill()\n\n// err message: 'server_config error: xxxx'\n\n/**\n * get Json via ajax\n * @param  {string} url  the server url\n * @param  {Object} data query data\n * @return {Promise}     promise resolve message\n */\nvar getJson = function (url, data) {\n    return new Promise(function (resolve, reject) {\n        $.ajax({\n            url: url,\n            data: data,\n            dataType: 'json',\n            success: function (response) {\n                if (response.success) {\n                    resolve(response.message)\n                } else {\n                    reject(new Error('server_config error: ' + response.message))\n                }\n            },\n            error: function (xhr, textStatus, errorMsg) {\n                reject(new Error('server_config error: ' + errorMsg))\n            }\n        })\n    })\n}\n\n/**\n * get server config\n * @param  {string} type   'image/media'\n * @param  {string} vendor 'upyun/qiniu/upyun_im'\n * @return {Promise}        promise resolve server config\n */\nexports.getConfig = function (type, vendor) {\n    if (type === 'image') {\n        window.location.origin = window.location.origin ||\n            window.location.protocol + \"//\" + window.location.hostname +\n            (window.location.port ? ':' + window.location.port: '')\n        var url = window.location.origin + '/imageUpload/getConfig/'\n        var query = {\n            vendor: vendor,\n            'return-url': window.location.origin + '/imageUpload/getResult/'\n        }\n        if (window.FormData) {\n            delete query['return-url']\n        }\n        return getJson(url, query).then(function (response) {\n            return {\n                action: response.uploadUrl,\n                data: response.uploadParams,\n                name: response.fileKey\n            }\n        })\n    }\n    return Promise.reject(new Error('server_config error: ' + 'media type invalid'))\n}\n\n/**\n * get image/media getPath\n * @param  {string} type    'image/media'\n * @param  {string} vendor 'upyun/qiniu/upyun_im'\n * @param  {Object} reponse {code, url,...}\n * @param  {string} suffix  '180x180'\n * @return {string}         url path, if response is invalid, return null\n */\nexports.getPath = function (type, vendor, response, suffix) {\n    if (type === 'image') {\n        response = $.parseJSON(response)\n        suffix = suffix ? ('_' + suffix) : '_sq'\n        if (response.code >= 200 && response.code < 300) {\n            if (vendor === 'upyun') {\n                var url = response.url.replace(/\\.$/, '')\n                url = url.split('.')\n                var type = url[1] ? ('.' + url[1]) : ''\n                url = url[0];\n                if (url.indexOf('#') !== -1) {\n                    type = url.split('#')[0]\n                }\n                return 'http://img' + (url.charCodeAt(1) % 3 + 4) + '.baixing.net' + url + type + suffix\n            } else if (vendor === 'qiniu') {\n                return 'http://img7.baixing.net/' + response.url.split('#')[0] + suffix\n            }\n        } else {\n            return null\n        }\n    }\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}]},{},[1])(1)\n});"],"sourceRoot":"/source/"}
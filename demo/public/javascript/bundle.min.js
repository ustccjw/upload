require=function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var f=n[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return r(n?n:t)},f,f.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e){(function(t){"use strict";function n(t,e){return window.File?t instanceof File?e!==!1&&/image/i.test(t.type)?(e=e||{},new Promise(function(n){var o=new FileReader;o.readAsArrayBuffer(t),o.onload=function(o){var s=new Blob([o.target.result]);window.URL=window.URL||window.webkitURL;var a=window.URL.createObjectURL(s),u=new Image;u.src=a,u.onload=function(){var o=i(u,t.type,e.max_width,e.max_height,e.quality),s=r(o);n(s)}}})):Promise.resolve(t):Promise.reject(new Error("file error")):Promise.reject(new Error("not support"))}function i(t,e,n,i,r){var o=t.width,s=t.height;n=n||o,i=i||s,r=r||.7,o>s?o>n&&(s=Math.round(s*=n/o),o=n):s>i&&(o=Math.round(o*=i/s),s=i);var a=document.createElement("canvas");a.width=o,a.height=s;var u=a.getContext("2d");return u.drawImage(t,0,0,o,s),a.toDataURL(e,r)}function r(t){var e;e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var n=t.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return new Blob([i],{type:n})}var o="undefined"!=typeof window?window.ES6Promise:"undefined"!=typeof t?t.ES6Promise:null;o.polyfill(),e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],upload:[function(t,e){(function(n){"use strict";function i(t){if(!(this instanceof i))return new i(t);r(t)&&(t={trigger:t});var e={trigger:null,name:null,action:null,data:null,accept:null,multiple:!0,change:null,error:null,success:null,progress:null,suffix:null,compress:null};t&&p.extend(e,t);var n=p(e.trigger).eq(0);e.action=e.action||n.data("action")||"/upload",e.name=e.name||n.attr("name")||n.data("name")||"file",e.data=e.data||s(n.data("data")),e.accept=e.accept||n.data("accept"),e.suffix=e.suffix||n.data("suffix"),e.compress=e.compress||s(n.data("compress")),e.success=e.success||n.data("success"),this.settings=e,this.setup(),this.bind()}function r(t){return"[object String]"===Object.prototype.toString.call(t)}function o(t){if(!t)return[];var e,n=[];for(var i in t)e=document.createElement("input"),e.type="hidden",e.name=i,e.value=t[i],n.push(e);return n}function s(t){if(!t)return{};for(var e={},n=t.split("&"),i=function(t){return decodeURIComponent(t.replace(/\+/g," "))},r=0;r<n.length;r++){var o=n[r].split("="),s=i(o[0]),a=i(o[1]);e[s]=a}return e}function a(t){for(var e=t.parentsUntil("body"),n=0,i=0;i<e.length;i++){var r=e.eq(i);"static"!==r.css("position")&&(n=parseInt(r.css("zIndex"),10)||n)}return n}function u(){var t="iframe-uploader-"+c,e=p('<iframe name="'+t+'" />').hide();return c+=1,e}var p="undefined"!=typeof window?window.jQuery:"undefined"!=typeof n?n.jQuery:null,f=t("./lib/compress"),c=0;i.prototype.setup=function(){this.form=p('<form method="post" enctype="multipart/form-data"target="" action="'+this.settings.action+'" />');var t=this.settings.data;this.form.append(o(t)),this.form.append(window.FormData?o({_uploader_:"formdata"}):o({_uploader_:"iframe"}));var e=document.createElement("input");e.type="file",e.name=this.settings.name,this.settings.accept&&(e.accept=this.settings.accept),this.settings.multiple&&(e.multiple=!0,e.setAttribute("multiple","multiple")),this.input=p(e);var n=p(this.settings.trigger);return this.input.attr("hidefocus",!0).css({position:"absolute",top:0,right:0,opacity:0,outline:0,cursor:"pointer",height:n.outerHeight(),fontSize:Math.max(64,5*n.outerHeight())}),this.form.append(this.input),this.form.css({position:"absolute",top:n.offset().top,left:n.offset().left,overflow:"hidden",width:n.outerWidth(),height:n.outerHeight(),zIndex:a(n)+10}).appendTo("body"),this},i.prototype.bind=function(){var t=this,e=p(t.settings.trigger);e.mouseenter(function(){t.form.css({top:e.offset().top,left:e.offset().left,width:e.outerWidth(),height:e.outerHeight()})}),t.bindInput()},i.prototype.bindInput=function(){var t=this;t.input.change(function(e){t._files=[];for(var n=t.input.val(),i=this.files||[{name:e.target.value}],r="",o=0;o<i.length;o++)r=i[o].name.split(".").pop(),-1===t.settings.suffix.indexOf(r)?t.settings.error&&t.settings.error(new Error("type error"),i[o].name):t._files.push(i[o]);t.settings.change?t.settings.change.call(t,t._files):n&&t.submit()})},i.prototype.submit=function(){var t=this;if(window.FormData&&t._files){var e=t._files;t.input.prop("disabled",!0);var n=new FormData(t.form.get(0));t.input.prop("disabled",!1);for(var i=0;i<e.length;i++)!function(e){f(e,t.settings.compress).then(function(i){n.append(t.settings.name,i,e.name),p.ajax({url:t.settings.action,type:"post",processData:!1,contentType:!1,data:n,xhr:function(){var n=p.ajaxSettings.xhr();return n.upload&&t.settings.progress&&n.upload.addEventListener("progress",function(n){var i=0,r=n.loaded||n.position,o=n.total;n.lengthComputable&&(i=Math.ceil(r/o*100)),t.settings.progress(n,r,o,i,e.name)},!1),n},success:function(n){t.settings.success&&t.settings.success(n,e.name)},error:function(n,i,r){t.settings.error&&t.settings.error(new Error(r),e.name)}})})["catch"](function(n){t.settings.error&&t.settings.error(new Error(n.message),e.name)})}(e[i]);return this}return t.iframe=u(),t.form.attr("target",t.iframe.attr("name")),t.iframe.data("fileName",t._files[0].name),p("body").append(t.iframe),t.iframe.one("load",function(){p('<iframe src="javascript:false;"></iframe>').appendTo(t.form).remove();var e;try{e=p.trim(p(this).contents().find("body").html())}catch(n){t.settings.error&&t.settings.error(new Error("cross domain"),p(this).data("fileName"))}e&&t.settings.success&&t.settings.success(e,p(this).data("fileName")),t.iframe.remove()}),t.form.submit(),this},i.prototype.refreshInput=function(){var t=this.input.clone();this.input.before(t),this.input.off("change"),this.input.remove(),this.input=t,this.bindInput()},i.prototype.change=function(t){return t?(this.settings.change=t,this):this},i.prototype.success=function(t){var e=this;return this.settings.success=function(n,i){e.refreshInput(),t&&t(n,i)},this},i.prototype.error=function(t){var e=this;return this.settings.error=function(n,i){t&&(e.refreshInput(),t(n,i))},this},i.prototype.progress=function(t){return t?(this.settings.progress=t,this):this},i.prototype.enable=function(){this.input.prop("disabled",!1),this.input.css("cursor","pointer")},i.prototype.disable=function(){this.input.prop("disabled",!0),this.input.css("cursor","not-allowed")},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/compress":1}],upyun:[function(t,e,n){(function(e){"use strict";{var i="undefined"!=typeof window?window.jQuery:"undefined"!=typeof e?e.jQuery:null,r="undefined"!=typeof window?window.ES6Promise:"undefined"!=typeof e?e.ES6Promise:null;t("./lib/compress")}r.polyfill();var o=function(t,e){return new Promise(function(n,r){i.ajax({url:t,data:e,success:function(t){t.success?n(t.message):r(new Error(t.message))},error:function(t,e,n){r(new Error(n))}})})};n.getConfig=function(t,e){t=t||"/config/upyun/",window.location.origin=window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var n=window.location.origin+t;return e=e||{},window.FormData?e["return-url"]&&delete e["return-url"]:e["return-url"]=!0,o(n,e).then(function(t){var e={};e.policy=t.policy,e.signature=t.signature;var n="http://v0.api.upyun.com/"+t.bucket,i={data:e,action:n,name:"file"};return i})},n.getPath=function(t){var e=i.parseJSON(t).url;return e="http://bxmedia.b0.upaiyun.com"+e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/compress":1}]},{},["upload","upyun"]);
//# sourceMappingURL=bundle.min.js.map